name: All fields tested

app_spec:
  image: "busybox:latest"

operations:
  - operation: CreateOrUpdate
    object:
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        labels:
          app.kubernetes.io/managed-by: yakup
          app.kubernetes.io/name: test-app
        name: test-app
        namespace: default
      spec:
        replicas: 1
        selector:
          matchLabels:
            app.kubernetes.io/managed-by: yakup
            app.kubernetes.io/name: test-app
        template:
          metadata:
            labels:
              app.kubernetes.io/managed-by: yakup
              app.kubernetes.io/name: test-app
          spec:
            containers:
              - image: 'busybox:latest'
                name: test-app
                envFrom:
                  - configMapRef:
                      name: test-app
                      optional: true
                  - secretRef:
                      name: test-app
                      optional: true
                volumeMounts:
                  - mountPath: /var/run/config/yakup.ibidem.no/test-app
                    name: test-app-configmap
                    readOnly: true
                  - mountPath: /var/run/secrets/yakup.ibidem.no/test-app
                    name: test-app-secret
                    readOnly: true
            volumes:
              - configMap:
                  name: test-app
                  optional: true
                  defaultMode: 0o644
                name: test-app-configmap
              - secret:
                  secretName: test-app
                  optional: true
                  defaultMode: 0o644
                name: test-app-secret
  - operation: DeleteIfExists
    object:
      apiVersion: v1
      kind: Service
      metadata:
        labels:
          app.kubernetes.io/managed-by: yakup
          app.kubernetes.io/name: test-app
        name: test-app
        namespace: default
